self.addEventListener("message",async a=>{let{type:t,url:o,fileType:s}=a.data;if(t==="readFile")try{let e=await fetch(o);if(!e.ok)throw new Error(`HTTP\u9519\u8BEF! \u72B6\u6001\u7801: ${e.status}`);let r={type:"success"};switch(s){case"arraybuffer":r.data=await e.arrayBuffer();break;case"text":r.text=await e.text();break;case"json":let n=await e.text();try{r.json=JSON.parse(n)}catch(f){throw new Error(`JSON\u89E3\u6790\u5931\u8D25: ${f.message}`)}break;default:throw new Error(`\u4E0D\u652F\u6301\u7684\u6587\u4EF6\u7C7B\u578B: ${s}`)}s==="arraybuffer"?self.postMessage(r,{transfer:[r.data]}):self.postMessage(r)}catch(e){let r=e instanceof Error?e.message:"\u672A\u77E5\u9519\u8BEF";self.postMessage({type:"error",error:r})}});

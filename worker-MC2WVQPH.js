self.addEventListener("message",async t=>{let{type:o,url:n,fileType:s}=t.data;if(o==="readFile")try{let r=await fetch(n);if(!r.ok)throw new Error(`HTTP\u9519\u8BEF! \u72B6\u6001\u7801: ${r.status}`);let e={type:"success"},a=r.clone();switch(s){case"arraybuffer":e.data=await a.arrayBuffer();break;case"text":e.text=await a.text();break;case"json":let f=await a.text();try{e.json=JSON.parse(f)}catch(c){throw new Error(`JSON\u89E3\u6790\u5931\u8D25: ${c.message}`)}break;default:throw new Error(`\u4E0D\u652F\u6301\u7684\u6587\u4EF6\u7C7B\u578B: ${s}`)}s==="arraybuffer"?self.postMessage(e,{transfer:[e.data]}):self.postMessage(e)}catch(r){let e=r instanceof Error?r.message:"\u672A\u77E5\u9519\u8BEF";self.postMessage({type:"error",error:e})}});
